{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\enemy.js"],"names":["mEmitter","require","config","cc","Class","extends","Component","properties","hit_frame","SpriteFrame","hp","speed","set","value","_speed","score","_sprite","_anim","_gameState","_updateGameState","onLoad","gameState","PLAYING","getComponent","Sprite","colider","PolygonCollider","Animation","updateGameState","bind","instance","registerEvent","event","UPDATE_GAMESTATE","data","stop","start","onEnemyKilled","removeEvent","node","destroy","onCollisionEnter","other","self","group","play","_clips","_name","tween","delay","call","emit","UPDATE_SCORE","spriteFrame","update","dt"],"mappings":";;;;;;AAAA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;AACA,IAAMC,SAASD,QAAQ,QAAR,CAAf;;AAEAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAWL,GAAGM,WADN;AAERC,YAAI,CAFI;AAGRC,eAAO;AACHC,iBAAK,aAASC,KAAT,EAAgB;AACjB,qBAAKC,MAAL,GAAcD,KAAd;AACH;AAHE,SAHC;;AASRE,eAAO,CATC;AAURC,iBAAS,IAVD;AAWRC,eAAO,IAXC;AAYRC,oBAAY,IAZJ;AAaRC,0BAAkB;AAClB;;AAdQ,KAHP;;AAqBL;;AAEAC,UAvBK,oBAuBI;AACL,aAAKF,UAAL,GAAkBhB,OAAOmB,SAAP,CAAiBC,OAAnC;AACA,aAAKN,OAAL,GAAe,KAAKO,YAAL,CAAkBpB,GAAGqB,MAArB,CAAf;AACA,aAAKC,OAAL,GAAe,KAAKF,YAAL,CAAkBpB,GAAGuB,eAArB,CAAf;AACA,aAAKT,KAAL,GAAa,KAAKM,YAAL,CAAkBpB,GAAGwB,SAArB,CAAb;AACA,aAAKR,gBAAL,GAAwB,KAAKS,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAAxB;AACA7B,iBAAS8B,QAAT,CAAkBC,aAAlB,CAAgC7B,OAAO8B,KAAP,CAAaC,gBAA7C,EAA+D,KAAKd,gBAApE;AACH,KA9BI;AA+BLS,mBA/BK,2BA+BWM,IA/BX,EA+BiB;AAClB,aAAKhB,UAAL,GAAkBgB,IAAlB;AACA,YAAIA,QAAQhC,OAAOmB,SAAP,CAAiBC,OAA7B,EACI,KAAKL,KAAL,CAAWkB,IAAX,GADJ,KAGI,KAAKlB,KAAL,CAAWmB,KAAX;AACP,KArCI;AAsCLC,iBAtCK,2BAsCW;AACZrC,iBAAS8B,QAAT,CAAkBQ,WAAlB,CAA8BpC,OAAO8B,KAAP,CAAaC,gBAA3C,EAA6D,KAAKd,gBAAlE;AACA,aAAKoB,IAAL,CAAUC,OAAV;AACH,KAzCI;;AA0CLC,sBAAkB,0BAASC,KAAT,EAAgBC,IAAhB,EAAsB;AAAA;;AACpC,YAAID,MAAMH,IAAN,CAAWK,KAAX,IAAoB,QAAxB,EAAkC;AAC9B,iBAAKlC,EAAL,IAAW,CAAX;AACA,gBAAI,KAAKA,EAAL,IAAW,CAAf,EAAkB;AACd,qBAAKO,KAAL,CAAW4B,IAAX,CAAgB,KAAK5B,KAAL,CAAW6B,MAAX,CAAkB,CAAlB,EAAqBC,KAArC;AACA5C,mBAAG6C,KAAH,CAAS,KAAKT,IAAd,EACKU,KADL,CACW,CADX,EAEKC,IAFL,CAEU,YAAM;AACRlD,6BAAS8B,QAAT,CAAkBqB,IAAlB,CAAuBjD,OAAO8B,KAAP,CAAaoB,YAApC,EAAkD,MAAKrC,KAAvD;AACA,0BAAKsB,aAAL;AACH,iBALL,EAMKD,KANL;AAOH,aATD,MASO,IAAI,KAAKpB,OAAL,CAAaqC,WAAb,KAA6B,KAAK7C,SAAlC,IAA+C,KAAKE,EAAL,GAAU,CAA7D,EAAgE;AACnE,qBAAKM,OAAL,CAAaqC,WAAb,GAA2B,KAAK7C,SAAhC;AACA,qBAAKS,KAAL,CAAWkB,IAAX;AACH;AACJ;AACJ,KA3DI;AA4DLC,SA5DK,mBA4DG,CAAE,CA5DL;AA6DLkB,UA7DK,kBA6DEC,EA7DF,EA6DM;AACP;AACA;AACA;AACA;AACA;AACH;AAnEI,CAAT","file":"enemy.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const mEmitter = require(\"mEmitter\");\r\nconst config = require(\"config\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        hit_frame: cc.SpriteFrame,\r\n        hp: 5,\r\n        speed: {\r\n            set: function(value) {\r\n                this._speed = value;\r\n            },\r\n        },\r\n\r\n        score: 1,\r\n        _sprite: null,\r\n        _anim: null,\r\n        _gameState: null,\r\n        _updateGameState: null,\r\n        //uwgduwgd\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        this._gameState = config.gameState.PLAYING\r\n        this._sprite = this.getComponent(cc.Sprite)\r\n        this.colider = this.getComponent(cc.PolygonCollider)\r\n        this._anim = this.getComponent(cc.Animation)\r\n        this._updateGameState = this.updateGameState.bind(this)\r\n        mEmitter.instance.registerEvent(config.event.UPDATE_GAMESTATE, this._updateGameState)\r\n    },\r\n    updateGameState(data) {\r\n        this._gameState = data\r\n        if (data != config.gameState.PLAYING)\r\n            this._anim.stop()\r\n        else\r\n            this._anim.start()\r\n    },\r\n    onEnemyKilled() {\r\n        mEmitter.instance.removeEvent(config.event.UPDATE_GAMESTATE, this._updateGameState)\r\n        this.node.destroy();\r\n    },\r\n    onCollisionEnter: function(other, self) {\r\n        if (other.node.group == \"bullet\") {\r\n            this.hp -= 1;\r\n            if (this.hp == 0) {\r\n                this._anim.play(this._anim._clips[0]._name)\r\n                cc.tween(this.node)\r\n                    .delay(1)\r\n                    .call(() => {\r\n                        mEmitter.instance.emit(config.event.UPDATE_SCORE, this.score)\r\n                        this.onEnemyKilled()\r\n                    })\r\n                    .start()\r\n            } else if (this._sprite.spriteFrame !== this.hit_frame && this.hp > 0) {\r\n                this._sprite.spriteFrame = this.hit_frame\r\n                this._anim.stop()\r\n            }\r\n        }\r\n    },\r\n    start() {},\r\n    update(dt) {\r\n        // if (this._gameState == config.gameState.PLAYING)\r\n        //     this.node.y -= this._speed;\r\n        // if (this.node.y <= -550) {\r\n        //     this.onEnemyKilled()\r\n        // }\r\n    },\r\n});"]}