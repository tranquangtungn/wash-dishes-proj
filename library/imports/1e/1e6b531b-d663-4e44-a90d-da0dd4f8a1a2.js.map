{"version":3,"sources":["../../../../assets/scripts/assets/scripts/game.js"],"names":["mEmitter","require","config","cc","Class","extends","Component","properties","bg_1","Node","bg_2","title","Label","gamePlaying","gamePause","gameReady","gameOver","score","scoreOver","pre_hero","Prefab","_hero","pre_creep","pre_assassin","pre_motherShip","pre_bullet","_waveContent","default","type","Array","_init","onLoad","instance","manager","director","getCollisionManager","enabled","getData","init","setTouch","registerEvent","event","UPDATE_SCORE","updateScore","bind","GAME_OVER","gameFinished","start","initMatrix","wave","content","map","item","index","x","y","Math","floor","log","creep","instantiate","node","addChild","update","dt","setBg","gameState","PLAYING","bulletTime","createBullet","isBgMove","height","zIndex","active","READY","string","spawnCreepTime","spawnAssasinTime","spawnMotherShipTime","level","spawnHero","waveCount","loader","loadRes","err","object","json","wavecount","on","name","pos_hero","getPosition","pos_mov","getDelta","setPosition","v2","OVER","removeAllBullet","removeAllEnemy","spawnCreeps","createEnemy","spawnAssassins","spawnMotherShips","pre_enemy","speed","random","enemy","js","getComponent","parent","Number","updateLevel","pos","bullet","children","i","length","onBulletKilled","onEnemyKilled","removeHero","onHeroKilled","clickBtn","sender","str","emit","UPDATE_GAMESTATE","PAUSE"],"mappings":"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","file":"game.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["const mEmitter = require(\"./mEmitter\");\nconst config = require(\"config\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        bg_1: cc.Node,\n        bg_2: cc.Node,\n        title: cc.Label,\n        gamePlaying: cc.Node,\n        gamePause: cc.Node,\n        gameReady: cc.Node,\n        gameOver: cc.Node,\n\n        score: cc.Label,\n        scoreOver: cc.Label,\n\n\n        pre_hero: cc.Prefab,\n        _hero: cc.Node,\n\n        pre_creep: cc.Prefab,\n        pre_assassin: cc.Prefab,\n        pre_motherShip: cc.Prefab,\n        pre_bullet: cc.Prefab,\n        _waveContent: {\n            default: null,\n            type: Array,\n        },\n        _init: false,\n    },\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        mEmitter.instance = new mEmitter();\n        //cc.log(config.event.UPDATE_SCORE)\n        let manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n        this.getData()\n        //manager.enabledDebugDraw = true;\n        this.init();\n        this.setTouch()\n        mEmitter.instance.registerEvent(config.event.UPDATE_SCORE, this.updateScore.bind(this))\n        mEmitter.instance.registerEvent(config.event.GAME_OVER, this.gameFinished.bind(this))\n    },\n    start() {\n\n    },\n    initMatrix() {\n        let wave = this._waveContent[1].content\n        wave.map((item, index) => {\n            if (item == 1) {\n                let x = index % 5\n                let y = Math.floor(index / 5);\n                cc.log(y)\n                let creep = cc.instantiate(this.pre_creep)\n                creep.x = x * 100 - 150;\n                creep.y = y * 100;\n                this.node.addChild(creep)\n            }\n\n        })\n    },\n    update(dt) {\n\n        this.setBg();\n        if (this._init) {\n            this.initMatrix()\n            this._init = false\n        }\n        if (this.gameState == config.gameState.PLAYING) {\n            this.bulletTime++;\n            // this.minhInitEnemy()\n            if (this.bulletTime == 10) {\n                this.bulletTime = 0;\n                this.createBullet();\n            }\n\n            // this.spawnCreeps(dt);\n            // this.spawnAssassins(dt);\n            // this.spawnMotherShips(dt);\n        }\n    },\n    init() {\n\n        this.isBgMove = false;\n        this.bg_1.y = 0;\n        this.bg_2.y = this.bg_1.y + this.bg_1.height;\n        this.gameReady.zIndex = 1;\n        // this.gameOver.zIndex = -1;\n        this.gamePause.zIndex = 2;\n        //this.score.zIndex = 3;\n        this.gameReady.active = true;\n        this.gamePlaying.active = false;\n        this.gamePause.active = false;\n        this.gameOver.active = false;\n\n        this.bulletTime = 0;\n        this.gameState = config.gameState.READY\n        this.score.string = 0;\n\n        this.spawnCreepTime = 0\n        this.spawnAssasinTime = 0\n        this.spawnMotherShipTime = 0\n\n        this.level = 1\n        this.spawnHero()\n    },\n    getData() {\n        this.waveCount = 0;\n        cc.loader.loadRes('waveconfig.json', function (err, object) {\n            if (err) {\n                cc.log(err)\n                return;\n            }\n            this._waveContent = object.json.wave;\n            this.waveCount = object.json.wavecount\n        }.bind(this))\n    },\n    setTouch() {\n        this.node.on(\"touchstart\", function (event) {\n            this.gameState = config.gameState.PLAYING;\n            this._init = true\n            this.gameReady.active = false;\n            this.gamePlaying.active = true;\n            //this.gameOver.active = false;\n            this.isBgMove = true;\n        }, this);\n        this.node.on(\"touchmove\", function (event) {\n            if (this._hero.name != \"\") {\n                let pos_hero = this._hero.getPosition()\n                let pos_mov = event.getDelta()\n                let x = pos_hero.x + pos_mov.x\n                let y = pos_hero.y + pos_mov.y\n                if (x < 280 && x > -280)\n                    if (y < 400 && y > -400)\n                        this._hero.setPosition(cc.v2(x, y))\n            }\n        }, this);\n        this.node.on(\"touchend\", function (event) {\n            cc.log(\"touchend\")\n        }, this)\n\n    },\n    gameFinished() {\n        cc.log(\"test\")\n        this.gameState = config.gameState.OVER;\n        this.removeAllBullet()\n        this.removeAllEnemy()\n\n        this.gameOver.active = true;\n        this.scoreOver.string = this.score.string;\n    },\n    spawnCreeps(dt) {\n        this.spawnCreepTime += dt;\n        if (this.spawnCreepTime >= 1 / this.level) {\n            this.spawnCreepTime = 0;\n            this.createEnemy(this.pre_creep, 1)\n        }\n    },\n    spawnAssassins(dt) {\n        this.spawnAssasinTime += dt;\n        if (this.spawnAssasinTime >= 2 / this.level) {\n            this.spawnAssasinTime = 0;\n            this.createEnemy(this.pre_assassin, 2)\n        }\n    },\n    spawnMotherShips(dt) {\n        this.spawnMotherShipTime += dt;\n        if (this.spawnMotherShipTime >= 5 / this.level) {\n            this.spawnMotherShipTime = 0;\n            this.createEnemy(this.pre_motherShip, 0.2)\n        }\n    },\n    createEnemy(pre_enemy, speed) {\n        let x = Math.floor(Math.random() * 600) + 1 - 300; // -300 300\n        let y = Math.floor(Math.random() * 900) + 1 + 550; // 550 1450\n        let enemy = cc.instantiate(pre_enemy)\n        let js = enemy.getComponent(\"enemy\")\n        js.speed = Math.floor(Math.random() * 2) + speed + this.level;\n        enemy.parent = this.node\n        enemy.setPosition(cc.v2(x, y))\n    },\n    spawnHero() {\n        this._hero = cc.instantiate(this.pre_hero)\n        this._hero.parent = this.node\n        this._hero.setPosition(cc.v2(0, -300))\n    },\n    updateScore(score) {\n        //cc.log(\"tets\")\n        this.score.string = Number(this.score.string) + score\n        this.updateLevel();\n    },\n    updateLevel() {\n        this.level = Math.floor(this.score.string / 50) + 1;\n    },\n    setBg() {\n        if (this.isBgMove) {\n            this.bg_2.y -= 0.5;\n            this.bg_1.y -= 0.5;\n            if (this.bg_1.y <= -this.bg_1.height)\n                this.bg_1.y = this.bg_2.y + this.bg_1.height;\n            if (this.bg_2.y <= -this.bg_2.height)\n                this.bg_2.y = this.bg_1.y + this.bg_2.height;\n        }\n    },\n    createBullet() {\n        if (this._hero.name != \"\") {\n            let pos = this._hero.getPosition()\n            let bullet = cc.instantiate(this.pre_bullet)\n            bullet.parent = this.node;\n            bullet.setPosition(cc.v2(pos.x, pos.y + this._hero.height / 2))\n        }\n    },\n\n    removeAllBullet() {\n        let children = this.node.children\n        for (let i = children.length - 1; i >= 0; i--) {\n            let bullet = children[i].getComponent(\"bullet\")\n            if (bullet)\n                bullet.onBulletKilled()\n        }\n    },\n    removeAllEnemy() {\n        let children = this.node.children\n        for (let i = children.length - 1; i >= 0; i--) {\n            let enemy = children[i].getComponent(\"enemy\")\n            if (enemy)\n                enemy.onEnemyKilled()\n        }\n    },\n    removeHero() {\n        let children = this.node.children\n        for (let i = children.length - 1; i >= 0; i--) {\n            let enemy = children[i].getComponent(\"hero\")\n            if (enemy) {\n                enemy.onHeroKilled()\n            }\n        }\n    },\n    clickBtn(sender, str) {\n        switch (str) {\n            case \"resume\":\n                cc.log(\"resume\")\n                this.isBgMove = true;\n                this.gamePause.active = false;\n                this.gamePlaying.active = true;\n                this.gameState = config.gameState.PLAYING;\n                mEmitter.instance.emit(config.event.UPDATE_GAMESTATE, this.gameState)\n                break;\n            case \"pause\":\n                cc.log(\"pause\")\n                //this.gameReady.active = false;\n                //this.gamePlaying.active = false;\n                this.gamePause.active = true;\n                //this.gameOver.active = false;\n                this.isBgMove = false;\n                this.gameState = config.gameState.PAUSE;\n                mEmitter.instance.emit(config.event.UPDATE_GAMESTATE, this.gameState)\n                break;\n            case \"restart\":\n                cc.log(\"restart\")\n                //this.gameOver.active = false;\n                this.gameState = config.gameState.READY;\n                this.removeAllBullet()\n                this.removeAllEnemy()\n                this.removeHero()\n                this.init();\n                break;\n        }\n    },\n});\n"]}