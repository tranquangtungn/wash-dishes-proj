{"version":3,"sources":["bullet.js"],"names":["mEmitter","require","config","cc","Class","extends","Component","properties","damage","speed","_gameState","gameState","PLAYING","effect_src","default","type","AudioClip","onLoad","js","node","parent","getComponent","effect","audioEngine","play","effectVolume","_updateGameState","updateGameState","bind","instance","registerEvent","event","UPDATE_GAMESTATE","updateEffect","number","log","setVolume","data","start","onCollisionEnter","other","self","a","group","onBulletKilled","removeEvent","destroy","update","dt","y"],"mappings":";;;;;;AAAA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;AACA,IAAMC,SAASD,QAAQ,QAAR,CAAf;AACAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,gBAAQ,CADA;AAERC,eAAO,CAFC;AAGRC,oBAAYR,OAAOS,SAAP,CAAiBC,OAHrB;AAIRC,oBAAY;AACRC,qBAAS,IADD;AAERC,kBAAMZ,GAAGa;AAFD;AAJJ,KAFP;AAWLC,UAXK,oBAWI;AACL,YAAIC,KAAK,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,YAAjB,CAA8B,MAA9B,CAAT;AACA,aAAKC,MAAL,GAAcnB,GAAGoB,WAAH,CAAeC,IAAf,CAAoB,KAAKX,UAAzB,EAAqC,KAArC,EAA4CK,GAAGO,YAA/C,CAAd;AACA,aAAKC,gBAAL,GAAwB,KAAKC,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CAAxB;AACA5B,iBAAS6B,QAAT,CAAkBC,aAAlB,CAAgC5B,OAAO6B,KAAP,CAAaC,gBAA7C,EAA+D,KAAKN,gBAApE;AAEH,KAjBI;AAkBLO,gBAlBK,wBAkBQC,MAlBR,EAkBgB;AACjB/B,WAAGgC,GAAH,CAAO,MAAP;AACAhC,WAAGoB,WAAH,CAAea,SAAf,CAAyB,KAAKd,MAA9B,EAAsCY,MAAtC;AACH,KArBI;AAsBLP,mBAtBK,2BAsBWU,IAtBX,EAsBiB;AAClB,aAAK3B,UAAL,GAAkB2B,IAAlB;AACH,KAxBI;AAyBLC,SAzBK,mBAyBG,CAEP,CA3BI;;AA4BLC,sBAAkB,0BAAUC,KAAV,EAAiBC,IAAjB,EAAuB;AACrC,YAAIC,IAAIF,MAAMrB,IAAN,CAAWwB,KAAX,IAAoB,OAA5B;AACA,YAAIH,MAAMrB,IAAN,CAAWwB,KAAX,IAAoB,OAAxB,EAAiC;AAC7B,iBAAKC,cAAL;AAEH;AACJ,KAlCI;AAmCLA,kBAnCK,4BAmCY;AACb5C,iBAAS6B,QAAT,CAAkBgB,WAAlB,CAA8B3C,OAAO6B,KAAP,CAAaC,gBAA3C,EAA6D,KAAKN,gBAAlE;;AAEA,aAAKP,IAAL,CAAU2B,OAAV;AAEH,KAxCI;AAyCLC,UAzCK,kBAyCEC,EAzCF,EAyCM;AACP,YAAI,KAAKtC,UAAL,IAAmBR,OAAOS,SAAP,CAAiBC,OAAxC,EACI,KAAKO,IAAL,CAAU8B,CAAV,IAAe,KAAKxC,KAApB;AACJ,YAAI,KAAKU,IAAL,CAAU8B,CAAV,IAAe,GAAnB,EAAwB;AACpB,iBAAKL,cAAL;AACH;AACJ;AA/CI,CAAT","file":"bullet.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const mEmitter = require(\"mEmitter\");\r\nconst config = require(\"config\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        damage: 1,\r\n        speed: 5,\r\n        _gameState: config.gameState.PLAYING,\r\n        effect_src: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n    onLoad() {\r\n        let js = this.node.parent.getComponent(\"game\");\r\n        this.effect = cc.audioEngine.play(this.effect_src, false, js.effectVolume);\r\n        this._updateGameState = this.updateGameState.bind(this)\r\n        mEmitter.instance.registerEvent(config.event.UPDATE_GAMESTATE, this._updateGameState)\r\n\r\n    },\r\n    updateEffect(number) {\r\n        cc.log(\"test\")\r\n        cc.audioEngine.setVolume(this.effect, number);\r\n    },\r\n    updateGameState(data) {\r\n        this._gameState = data\r\n    },\r\n    start() {\r\n\r\n    },\r\n    onCollisionEnter: function (other, self) {\r\n        let a = other.node.group == \"enemy\"\r\n        if (other.node.group == \"enemy\") {\r\n            this.onBulletKilled()\r\n\r\n        }\r\n    },\r\n    onBulletKilled() {\r\n        mEmitter.instance.removeEvent(config.event.UPDATE_GAMESTATE, this._updateGameState)\r\n\r\n        this.node.destroy();\r\n\r\n    },\r\n    update(dt) {\r\n        if (this._gameState == config.gameState.PLAYING)\r\n            this.node.y += this.speed;\r\n        if (this.node.y >= 460) {\r\n            this.onBulletKilled()\r\n        }\r\n    },\r\n});"]}